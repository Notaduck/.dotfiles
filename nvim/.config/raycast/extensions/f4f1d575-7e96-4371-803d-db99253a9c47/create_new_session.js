"use strict";var D=Object.create;var p=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var I=(e,t)=>{for(var o in t)p(e,o,{get:t[o],enumerable:!0})},w=(e,t,o,l)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of C(t))!v.call(e,a)&&a!==o&&p(e,a,{get:()=>t[a],enumerable:!(l=F(t,a))||l.enumerable});return e};var k=(e,t,o)=>(o=e!=null?D(P(e)):{},w(t||!e||!e.__esModule?p(o,"default",{value:e,enumerable:!0}):o,e)),B=e=>w(p({},"__esModule",{value:!0}),e);var H={};I(H,{default:()=>E});module.exports=B(H);var f=require("react"),s=require("@raycast/api");var S=require("node:child_process");var d=Object.assign({},process.env,{PATH:"/usr/local/bin:/usr/bin:/opt/homebrew/bin"});var g=require("@raycast/api");var M=require("@raycast/api");var h=k(require("node:fs"));function T(e){return(0,S.exec)("tmux list-sessions | awk '{print $1}' | sed 's/://'",{env:d},e)}function N(e){return h.default.existsSync(e)}function $(e,t,o){let l=t.replace(" ","\\ ");return(0,S.exec)(`tmux new-session -d -s ${e} -c ${l}`,{env:d},o)}var c=require("react/jsx-runtime");function E(){let[e,t]=(0,f.useState)(!1),[o,l]=(0,f.useState)(""),[a,x]=(0,f.useState)(""),y=(0,s.getPreferenceValues)(),b=y.defaultDirectory?[y.defaultDirectory]:["/"];return(0,c.jsxs)(s.Form,{isLoading:e,navigationTitle:"Create New Tmux Session",actions:(0,c.jsx)(s.ActionPanel,{children:(0,c.jsx)(s.Action.SubmitForm,{title:"Create New Session",onSubmit:async n=>{let u=n.newSessionName,m=n.newSessionDirectory[0];t(!0);let i=await(0,s.showToast)({style:s.Toast.Style.Animated,title:""});if(!u){let r="Session name is required";l(r),i.style=s.Toast.Style.Failure,i.message=r,t(!1);return}if(m&&!N(m)){let r="The directory you selected does not exist";x(r),i.style=s.Toast.Style.Failure,i.message=r,t(!1);return}$(u,m||y.defaultDirectory||"/",(r,V,A)=>{if(r||A){console.error(`exec error: ${r}`),t(!1),i.style=s.Toast.Style.Failure,i.message="Failed to create new session";return}i.style=s.Toast.Style.Success,i.message=`New session ${u} is setup successfully`,t(!1),(0,s.popToRoot)()})}})}),children:[(0,c.jsx)(s.Form.TextField,{title:"New Session Name",id:"newSessionName",error:o,onChange:n=>{!n||n.length===0||T((u,m,i)=>{(u||i)&&(console.error(`exec error: ${u}`),t(!1)),m.trim().split(`
`).includes(n)?l("Session name already exists"):l("")})}}),(0,c.jsx)(s.Form.FilePicker,{title:"New Session Directory",id:"newSessionDirectory",allowMultipleSelection:!1,defaultValue:b,canChooseDirectories:!0,canChooseFiles:!1,error:a,onChange:n=>{!n||n.length===0||x("")}})]})}
